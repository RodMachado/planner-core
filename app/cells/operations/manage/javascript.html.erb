<script type="text/javascript">

OperationsApp = new Backbone.Marionette.Application();

OperationsApp.ReportManagement = (function(Backbone){

    var GenericForm = Backbone.Form.extend({
    });

    var PanelsByRoomColModel = [
                    {name: 'room',      label : '<%= t "Room" %>',  jsonmap: "room", width: 50},
                    {name: 'venue',     label : '<%= t "Venue" %>', jsonmap: "venue", width: 50},
                    {name: 'day',       label : '<%= t "Time" %>',  jsonmap: "day",    width: 30},
                    {name: 'time',      label : '<%= t "Time" %>',  jsonmap: "time_slot",    width: 30},
                    {name: 'item',      label : '<%= t "Item" %>',  jsonmap: "item" },
                    {name: 'equipment', label : '<%= t "Equipment" %>',  jsonmap: "equipment", width: 70, formatter: AppUtils.arrayToString},
    ];
    
    var PanelsByTimeslotColModel = [
                    {name: 'day',       label : '<%= t "Time" %>',  jsonmap: "day",    width: 30},
                    {name: 'time',      label : '<%= t "Time" %>',  jsonmap: "time_slot",    width: 30},
                    {name: 'room',      label : '<%= t "Room" %>',  jsonmap: "room", width: 50},
                    {name: 'venue',     label : '<%= t "Venue" %>', jsonmap: "venue", width: 50},
                    {name: 'item',      label : '<%= t "Item" %>',  jsonmap: "item" },
                    {name: 'equipment', label : '<%= t "Equipment" %>',  jsonmap: "equipment", width: 70, formatter: AppUtils.arrayToString},
    ];
    
    var Workspace = Backbone.Router.extend({

        routes : {
            'panels_by_room'        : 'panels_by_room',
            'panels_by_timeslot'    : 'panels_by_timeslot'
            // TODO - add get scheduled participants contact details
        },
        
        panels_by_room : function() {
            ReportBase.reportRegion.close();
            ReportBase.resultRegion.close();
            ReportBase.reportRegion.show(new ReportBase.ReportView({
                form        : GenericForm,
                endPoint    : '/planner_reports/panels_by_room',
                colModel    : PanelsByRoomColModel,
                caption     : '<%= t "Panels By Room" %>'
            }));
        },
        
        panels_by_timeslot : function() {
            ReportBase.reportRegion.close();
            ReportBase.resultRegion.close();
            ReportBase.reportRegion.show(new ReportBase.ReportView({
                form        : GenericForm,
                endPoint    : '/planner_reports/panels_by_timeslot',
                colModel    : PanelsByTimeslotColModel,
                caption     : '<%= t "Panels By Timeslot" %>'
            }));
        }
                
    });
    
    /*
     * 
     */
    return {
        init : function(options) {
            new Workspace();
            Backbone.history.start();
        }
    }
    
})(Backbone);

/*
 * 
 */
jQuery(document).ready(function() {
    OperationsApp.addInitializer(OperationsApp.ReportManagement.init);
    OperationsApp.start({});
});

</script>
