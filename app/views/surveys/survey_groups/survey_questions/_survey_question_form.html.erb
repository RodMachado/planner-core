<%= error_messages_for :surveyQuestion %>
<% form_for [@survey,@group,@question], :html => {:class => "question-form", :id => "question_form-questionid-" + @question.id.to_s} do |f| %>
<div class='group_form'>
    <div class='line'><div class='field_name'>Title:</div><div class='field_value'><%= f.text_field :title %></div></div>
    <div class='line'><div class='field_name'>Question:</div><div class='field_value'><%= f.text_field :question %></div></div>
    <div class='line'>
        <div class='field_name'>Question Type:</div>
        <div class='field_value'><%= f.select :question_type, [:textfield, :textbox, :singlechoice, :multiplechoice, :selectionbox], {}, {:class =>'question-type'} %></div>
    </div>
    <fieldset class="coolfieldset survey_question_advanced">
        <legend>Advanced</legend>
        <div class='line'><div class='field_name'>Tag Label:</div><div class='field_value'><%= f.text_field :tags_label %></div></div>
        <div class='line'><div class='field_name'>Additional:</div><div class='field_value'><%= f.text_field :additional %></div></div>
        <div class='line'><div class='field_name'>Validation:</div><div class='field_value'><%= f.text_field :validation %></div></div>
    </fieldset>

    <%
    # ------------------------------------------------------------------------
    # The input area for format information
    %>
    <fieldset class="coolfieldset survey_question_format">
        <legend>Formatting</legend>
        <%= render :partial => 'format_form', :object => @question.survey_format %>
    </fieldset>
    <%
    # ------------------------------------------------------------------------
    %>

    <%
    # ------------------------------------------------------------------------
    # The input area for answers (if applicable)
    %>
    <% answersstyle = (@question.question_type.to_s.include? 'text') ? 'none' : 'block' %>
    <% answersid = "survey_answers_#{@question.id}" %>
    <div class='question-answers' style='<%= "display: #{answersstyle};"%>'>
        <fieldset class="coolfieldset survey_question_answers" >
            <legend>Answers</legend>
            <div id="<%= answersid %>">
                <%= render :partial => 'answer_form', :collection => @question.survey_answers %>
            </div>
            <div><%= add_answer_link "Add an Answer", answersid %></div>
        </fieldset>
    </div>
    <%
    # ------------------------------------------------------------------------
    %>

    <div class='form-buttons'>
        <%= f.submit "Submit" %>
        <%if @question.id != nil %>
            <%= link_to "Cancel", survey_survey_group_survey_question_path(@survey,@group,@question), {:class =>'cancel-link'} %> <!-- TODO - change to a button ... -->
        <%else%>
            <%= link_to "Cancel", survey_survey_group_survey_questions_path(@survey,@group), {:class =>'cancel-link'} %> <!-- TODO - change to a button ... -->
        <%end%>
    </div>
</div>
<% end %>
